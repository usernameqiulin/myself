[
  {
    "__docId__": 1,
    "kind": "external",
    "name": "Infinity",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Infinity",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Infinity",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 2,
    "kind": "external",
    "name": "NaN",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/NaN",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~NaN",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 3,
    "kind": "external",
    "name": "undefined",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~undefined",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 4,
    "kind": "external",
    "name": "null",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/null",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~null",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 5,
    "kind": "external",
    "name": "Object",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Object",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 6,
    "kind": "external",
    "name": "object",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~object",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 7,
    "kind": "external",
    "name": "Function",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Function",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 8,
    "kind": "external",
    "name": "function",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~function",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 9,
    "kind": "external",
    "name": "Boolean",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Boolean",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 10,
    "kind": "external",
    "name": "boolean",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~boolean",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 11,
    "kind": "external",
    "name": "Symbol",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Symbol",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 12,
    "kind": "external",
    "name": "Error",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Error",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 13,
    "kind": "external",
    "name": "EvalError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/EvalError",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~EvalError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 14,
    "kind": "external",
    "name": "InternalError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/InternalError",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~InternalError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 15,
    "kind": "external",
    "name": "RangeError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RangeError",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~RangeError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 16,
    "kind": "external",
    "name": "ReferenceError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ReferenceError",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~ReferenceError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 17,
    "kind": "external",
    "name": "SyntaxError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SyntaxError",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~SyntaxError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 18,
    "kind": "external",
    "name": "TypeError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypeError",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~TypeError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 19,
    "kind": "external",
    "name": "URIError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/URIError",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~URIError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 20,
    "kind": "external",
    "name": "Number",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Number",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 21,
    "kind": "external",
    "name": "number",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~number",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 22,
    "kind": "external",
    "name": "Date",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Date",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 23,
    "kind": "external",
    "name": "String",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~String",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 24,
    "kind": "external",
    "name": "string",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~string",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 25,
    "kind": "external",
    "name": "RegExp",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~RegExp",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 26,
    "kind": "external",
    "name": "Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 27,
    "kind": "external",
    "name": "Int8Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Int8Array",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Int8Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 28,
    "kind": "external",
    "name": "Uint8Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Uint8Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 29,
    "kind": "external",
    "name": "Uint8ClampedArray",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8ClampedArray",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Uint8ClampedArray",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 30,
    "kind": "external",
    "name": "Int16Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Int16Array",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Int16Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 31,
    "kind": "external",
    "name": "Uint16Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint16Array",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Uint16Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 32,
    "kind": "external",
    "name": "Int32Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Int32Array",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Int32Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 33,
    "kind": "external",
    "name": "Uint32Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint32Array",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Uint32Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 34,
    "kind": "external",
    "name": "Float32Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Float32Array",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Float32Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 35,
    "kind": "external",
    "name": "Float64Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Float64Array",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Float64Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 36,
    "kind": "external",
    "name": "Map",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Map",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 37,
    "kind": "external",
    "name": "Set",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Set",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 38,
    "kind": "external",
    "name": "WeakMap",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakMap",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~WeakMap",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 39,
    "kind": "external",
    "name": "WeakSet",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakSet",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~WeakSet",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 40,
    "kind": "external",
    "name": "ArrayBuffer",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~ArrayBuffer",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 41,
    "kind": "external",
    "name": "DataView",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~DataView",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 42,
    "kind": "external",
    "name": "JSON",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~JSON",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 43,
    "kind": "external",
    "name": "Promise",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Promise",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 44,
    "kind": "external",
    "name": "Generator",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Generator",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 45,
    "kind": "external",
    "name": "GeneratorFunction",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/GeneratorFunction",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~GeneratorFunction",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 46,
    "kind": "external",
    "name": "Reflect",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Reflect",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Reflect",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 47,
    "kind": "external",
    "name": "Proxy",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Proxy",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 48,
    "kind": "file",
    "name": "src/Interface.js",
    "content": "import { CHANNEL, CHANNEL_MESSAGE, CHANNEL_CONNECT_STATUS_CHANGE } from './constants';\nimport EventEmitter from '@bone/event-emitter';\nimport logger from '@bone/logger';\n\nconst log = logger.create({\n    module: 'ChannelInterface',\n    label: ['Bone', 'channel']\n});\n\n/**\n * channel接口层\n * @interface\n */\nclass ChannelInterface {\n    /**\n     * 连接状态变更事件名\n     * @type {String}\n     */\n    EVENT_CONNECT_STATUS_CHANGE = CHANNEL_CONNECT_STATUS_CHANGE;\n\n    constructor({\n        bridge\n    }){\n        /**\n         * bridge引用\n         * @private\n         * @type {Object} \n         */\n        this.bridge = bridge;\n\n        Object.assign(this, EventEmitter);\n        \n        // delegate event\n        bridge.on(CHANNEL_CONNECT_STATUS_CHANGE, onConnectStatusChange.bind(this));\n    }\n\n    /**\n     * 启动接口，channel的其他接口必须等到ready之后才可以安全的调用\n     * @param {Object} conf 启动配置\n     * @param {String} conf.id 用户id\n     * @param {String} conf.token 用户登录态token\n     * @returns {Promise}\n     * @example\n     *  channel\n     *      .ready()\n     *      .then(()=>{\n     *          // safe to call channel methods now\n     *          channel.subscribe('/demo/push', (msg)=>{\n     *              console.log(msg);\n     *          });\n     *      })\n     *      .catch((err)=>{\n     *          // initialization failed\n     * \n     *          // handle error here\n     *          console.error(err);\n     *      });\n     */\n    ready(conf){\n        log.debug('ready: waiting for interface to be ready', conf);\n\n        return new Promise((resolve, reject)=>{\n            this.bridge.call(CHANNEL, 'ready', [conf], (err)=>{\n                if(err){\n                    log.warn('ready: initialization error', err);\n\n                    reject(err);\n                    return;\n                }\n\n                log.debug('ready: initialization done', err);\n                resolve();\n            });\n        });\n    }\n\n    /**\n     * 订阅topic\n     * @param {String} topic 需要订阅的topic\n     * @param {Function} callback topic的响应函数，注意：该函数可能被多次调用\n     * @example\n     *      channel.subscribe('/demo/push', (msg)=>{\n     *          console.log('/demo/push message received:', msg);\n     *      });\n     */\n    subscribe(topic, callback){\n        log.debug('subscribe:', topic);\n        this.bridge.call(CHANNEL, 'subscribe', [topic], callback);\n    }\n\n    /**\n     * 取消订阅\n     * @param {String} topic 取消订阅的topic \n     * @param {Function} callback 订阅时传入的响应函数，注意：必须是同一个函数，否则无法取消订阅\n     * @example\n     *      channel.unsubscribe('/demo/push', callback);\n     */\n    unsubscribe(topic, callback){\n        log.debug('unsubscribe:', topic);\n        this.bridge.call(CHANNEL, 'unsubscribe', [topic], callback);\n    }\n\n    /**\n     * 发布topic\n     * @param {String} topic 需要发布的topic\n     * @param {Object} payload topic的消息内容\n     * @param {Function} callback topic发布成功时的回调\n     * @example\n     *      channel.publish(\n     *          '/demo/publish_topic', \n     *          { msg: 'hello' }\n     *          ()=>{\n     *              console.log('/demo/publish_topic message sent');\n     *          }\n     *      );\n     */\n    publish(topic, payload, callback){\n        log.debug('publish:', topic, payload);\n        this.bridge.call(CHANNEL, 'publish', [topic, payload], callback);\n    }\n\n    /**\n     * RPC请求，即利用长连通道进行一次请求和响应的动作\n     * @param {String} topic 做RPC请求的topic\n     * @param {Object} payload topic的消息内容\n     * @param {Function} callback RPC的响应报文回调函数\n     * @example\n     *      channel.request(\n     *          '/demo/rpc_topic',\n     *          { msg: 'hello' }\n     *          (err, res)=>{\n     *              if(err){\n     *                  console.warn('/demo/rpc_topic message error:', err);\n     *                  return;\n     *              }\n     * \n     *              console.log('/demo/rpc_topic response message:', res);\n     *          }\n     *      )\n     */\n    request(topic, payload, callback){\n        log.debug('request:', topic, payload);\n        this.bridge.call(CHANNEL, 'request', [topic, payload], callback);\n    }\n}\n\nfunction onConnectStatusChange(...args){\n    /**\n     * 连接状态变化事件\n     * @event\n     * @param {String} 当前连接状态：connected/disconnected\n     */\n    this.emit(CHANNEL_CONNECT_STATUS_CHANGE, ...args);\n}\n\nexport default ChannelInterface;",
    "static": true,
    "longname": "/Users/NicolasWan/Desktop/WorkSpace/JavaScript/aliplus/bone/channel/src/Interface.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 49,
    "kind": "variable",
    "name": "log",
    "memberof": "src/Interface.js",
    "static": true,
    "longname": "src/Interface.js~log",
    "access": "public",
    "export": false,
    "importPath": "@bone/channel/src/Interface.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 5,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 50,
    "kind": "function",
    "name": "onConnectStatusChange",
    "memberof": "src/Interface.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/Interface.js~onConnectStatusChange",
    "access": "public",
    "export": false,
    "importPath": "@bone/channel/src/Interface.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 147,
    "undocument": true,
    "params": [
      {
        "name": "args",
        "types": [
          "...*"
        ],
        "spread": true
      }
    ],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 51,
    "kind": "class",
    "name": "ChannelInterface",
    "memberof": "src/Interface.js",
    "static": true,
    "longname": "src/Interface.js~ChannelInterface",
    "access": "public",
    "export": true,
    "importPath": "@bone/channel/src/Interface.js",
    "importStyle": "ChannelInterface",
    "description": "channel接口层",
    "lineNumber": 14,
    "interface": true
  },
  {
    "__docId__": 52,
    "kind": "member",
    "name": "EVENT_CONNECT_STATUS_CHANGE",
    "memberof": "src/Interface.js~ChannelInterface",
    "static": false,
    "longname": "src/Interface.js~ChannelInterface#EVENT_CONNECT_STATUS_CHANGE",
    "access": "public",
    "description": "连接状态变更事件名",
    "lineNumber": 19,
    "type": {
      "nullable": null,
      "types": [
        "String"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 53,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "src/Interface.js~ChannelInterface",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/Interface.js~ChannelInterface#constructor",
    "access": "public",
    "description": null,
    "lineNumber": 21,
    "undocument": true
  },
  {
    "__docId__": 54,
    "kind": "member",
    "name": "bridge",
    "memberof": "src/Interface.js~ChannelInterface",
    "static": false,
    "longname": "src/Interface.js~ChannelInterface#bridge",
    "access": "private",
    "description": "bridge引用",
    "lineNumber": 29,
    "type": {
      "nullable": null,
      "types": [
        "Object"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 55,
    "kind": "method",
    "name": "ready",
    "memberof": "src/Interface.js~ChannelInterface",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/Interface.js~ChannelInterface#ready",
    "access": "public",
    "description": "启动接口，channel的其他接口必须等到ready之后才可以安全的调用",
    "examples": [
      " channel\n     .ready()\n     .then(()=>{\n         // safe to call channel methods now\n         channel.subscribe('/demo/push', (msg)=>{\n             console.log(msg);\n         });\n     })\n     .catch((err)=>{\n         // initialization failed\n\n         // handle error here\n         console.error(err);\n     });"
    ],
    "lineNumber": 59,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Promise}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Object"
        ],
        "spread": false,
        "optional": false,
        "name": "conf",
        "description": "启动配置"
      },
      {
        "nullable": null,
        "types": [
          "String"
        ],
        "spread": false,
        "optional": false,
        "name": "conf.id",
        "description": "用户id"
      },
      {
        "nullable": null,
        "types": [
          "String"
        ],
        "spread": false,
        "optional": false,
        "name": "conf.token",
        "description": "用户登录态token"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Promise"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 56,
    "kind": "method",
    "name": "subscribe",
    "memberof": "src/Interface.js~ChannelInterface",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/Interface.js~ChannelInterface#subscribe",
    "access": "public",
    "description": "订阅topic",
    "examples": [
      "     channel.subscribe('/demo/push', (msg)=>{\n         console.log('/demo/push message received:', msg);\n     });"
    ],
    "lineNumber": 86,
    "params": [
      {
        "nullable": null,
        "types": [
          "String"
        ],
        "spread": false,
        "optional": false,
        "name": "topic",
        "description": "需要订阅的topic"
      },
      {
        "nullable": null,
        "types": [
          "Function"
        ],
        "spread": false,
        "optional": false,
        "name": "callback",
        "description": "topic的响应函数，注意：该函数可能被多次调用"
      }
    ],
    "return": null
  },
  {
    "__docId__": 57,
    "kind": "method",
    "name": "unsubscribe",
    "memberof": "src/Interface.js~ChannelInterface",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/Interface.js~ChannelInterface#unsubscribe",
    "access": "public",
    "description": "取消订阅",
    "examples": [
      "     channel.unsubscribe('/demo/push', callback);"
    ],
    "lineNumber": 98,
    "params": [
      {
        "nullable": null,
        "types": [
          "String"
        ],
        "spread": false,
        "optional": false,
        "name": "topic",
        "description": "取消订阅的topic"
      },
      {
        "nullable": null,
        "types": [
          "Function"
        ],
        "spread": false,
        "optional": false,
        "name": "callback",
        "description": "订阅时传入的响应函数，注意：必须是同一个函数，否则无法取消订阅"
      }
    ],
    "return": null
  },
  {
    "__docId__": 58,
    "kind": "method",
    "name": "publish",
    "memberof": "src/Interface.js~ChannelInterface",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/Interface.js~ChannelInterface#publish",
    "access": "public",
    "description": "发布topic",
    "examples": [
      "     channel.publish(\n         '/demo/publish_topic', \n         { msg: 'hello' }\n         ()=>{\n             console.log('/demo/publish_topic message sent');\n         }\n     );"
    ],
    "lineNumber": 117,
    "params": [
      {
        "nullable": null,
        "types": [
          "String"
        ],
        "spread": false,
        "optional": false,
        "name": "topic",
        "description": "需要发布的topic"
      },
      {
        "nullable": null,
        "types": [
          "Object"
        ],
        "spread": false,
        "optional": false,
        "name": "payload",
        "description": "topic的消息内容"
      },
      {
        "nullable": null,
        "types": [
          "Function"
        ],
        "spread": false,
        "optional": false,
        "name": "callback",
        "description": "topic发布成功时的回调"
      }
    ],
    "return": null
  },
  {
    "__docId__": 59,
    "kind": "method",
    "name": "request",
    "memberof": "src/Interface.js~ChannelInterface",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/Interface.js~ChannelInterface#request",
    "access": "public",
    "description": "RPC请求，即利用长连通道进行一次请求和响应的动作",
    "examples": [
      "     channel.request(\n         '/demo/rpc_topic',\n         { msg: 'hello' }\n         (err, res)=>{\n             if(err){\n                 console.warn('/demo/rpc_topic message error:', err);\n                 return;\n             }\n\n             console.log('/demo/rpc_topic response message:', res);\n         }\n     )"
    ],
    "lineNumber": 141,
    "params": [
      {
        "nullable": null,
        "types": [
          "String"
        ],
        "spread": false,
        "optional": false,
        "name": "topic",
        "description": "做RPC请求的topic"
      },
      {
        "nullable": null,
        "types": [
          "Object"
        ],
        "spread": false,
        "optional": false,
        "name": "payload",
        "description": "topic的消息内容"
      },
      {
        "nullable": null,
        "types": [
          "Function"
        ],
        "spread": false,
        "optional": false,
        "name": "callback",
        "description": "RPC的响应报文回调函数"
      }
    ],
    "return": null
  },
  {
    "__docId__": 60,
    "kind": "file",
    "name": "src/NativeImplement.js",
    "content": "import { \n    CHANNEL, \n    CHANNEL_MESSAGE, \n    CHANNEL_CONNECT_STATUS_CHANGE, \n    CHANNEL_NA_DOWSTREAM, \n    CHANNEL_NA_CONNECT_STATUS_CHANGE \n} from './constants';\nimport EventEmitter from '@bone/event-emitter';\nimport logger from '@bone/logger';\n\nconst log = logger.create({\n    module: 'ChannelNativeBridge',\n    label: ['channel', 'bridge']\n});\n\nclass ChannelNativeBridge {\n    static MODULE_NAME = CHANNEL;\n    \n    constructor({\n        bridge,\n        nativeBridge\n    }){\n        // mixin event-emitter for event dispatching\n        Object.assign(this, EventEmitter);\n        this.bridge = bridge;\n        this.nativeBridge = nativeBridge;\n\n        // dispatch native events\n        bridge.on(CHANNEL_NA_DOWSTREAM, onMessageArried.bind(this));\n        bridge.on(CHANNEL_NA_CONNECT_STATUS_CHANGE, onConnectStatusChange.bind(this));\n    }\n\n    // fake ready\n    // it's useful for web initialization\n    ready(args, callback){\n        // ignore conf cause connection has been established by app\n        setTimeout(callback, 0);\n    }\n\n    subscribe([topic], callback){\n        // listen to local event dispatcher\n        // message will be sent through native event CHANNEL_NA_DOWSTREAM\n        this.on(topic, callback);\n        \n        if(this.listenerCount(topic) > 1){\n            return;\n        }\n\n        // if it's the first listener\n        // subscribe to native\n        // so that the topic will be passed through native filter\n        this.nativeBridge.call(CHANNEL, 'subscribe', [topic], (err)=>{\n            if(err){\n                log.warn(`subscribe ${topic} failed:`, err);\n                throw err;\n            }\n        });\n    }\n\n    unsubscribe([topic], callback){\n        this.off(topic, callback);\n\n        if(this.listenerCount(topic) > 0 ){\n            return;\n        }\n\n        // if listener queue is empty, unsubscribe from native\n        this.nativeBridge.call(CHANNEL, 'unsubscribe', [topic], (err)=>{\n            if(err){\n                log.warn(`unsubscribe ${topic} failed:`, err);\n                throw err;\n            }\n        });\n    }\n\n    publish([topic, payload], callback){\n        this.nativeBridge.call(CHANNEL, 'publish', [topic, payload], callback);\n    }\n\n    request([topic, payload], callback){\n        this.nativeBridge.call(CHANNEL, 'request', [topic, payload], callback);\n    }\n}\n\nfunction onMessageArried(msg){\n    // dispatch events\n    // with err=null\n    this.emit(msg.topic, msg);\n}\n\nfunction onConnectStatusChange(statusType){\n    this.emit(CHANNEL_CONNECT_STATUS_CHANGE, statusType.status);\n}\n\nexport default ChannelNativeBridge;",
    "static": true,
    "longname": "/Users/NicolasWan/Desktop/WorkSpace/JavaScript/aliplus/bone/channel/src/NativeImplement.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 61,
    "kind": "variable",
    "name": "log",
    "memberof": "src/NativeImplement.js",
    "static": true,
    "longname": "src/NativeImplement.js~log",
    "access": "public",
    "export": false,
    "importPath": "@bone/channel/src/NativeImplement.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 11,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 62,
    "kind": "function",
    "name": "onMessageArried",
    "memberof": "src/NativeImplement.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/NativeImplement.js~onMessageArried",
    "access": "public",
    "export": false,
    "importPath": "@bone/channel/src/NativeImplement.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 85,
    "undocument": true,
    "params": [
      {
        "name": "msg",
        "types": [
          "*"
        ]
      }
    ],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 63,
    "kind": "function",
    "name": "onConnectStatusChange",
    "memberof": "src/NativeImplement.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/NativeImplement.js~onConnectStatusChange",
    "access": "public",
    "export": false,
    "importPath": "@bone/channel/src/NativeImplement.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 91,
    "undocument": true,
    "params": [
      {
        "name": "statusType",
        "types": [
          "*"
        ]
      }
    ],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 64,
    "kind": "class",
    "name": "ChannelNativeBridge",
    "memberof": "src/NativeImplement.js",
    "static": true,
    "longname": "src/NativeImplement.js~ChannelNativeBridge",
    "access": "public",
    "export": true,
    "importPath": "@bone/channel/src/NativeImplement.js",
    "importStyle": "ChannelNativeBridge",
    "description": null,
    "lineNumber": 16,
    "undocument": true,
    "interface": false
  },
  {
    "__docId__": 65,
    "kind": "member",
    "name": "MODULE_NAME",
    "memberof": "src/NativeImplement.js~ChannelNativeBridge",
    "static": true,
    "longname": "src/NativeImplement.js~ChannelNativeBridge.MODULE_NAME",
    "access": "public",
    "description": null,
    "lineNumber": 17,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 66,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "src/NativeImplement.js~ChannelNativeBridge",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/NativeImplement.js~ChannelNativeBridge#constructor",
    "access": "public",
    "description": null,
    "lineNumber": 19,
    "undocument": true
  },
  {
    "__docId__": 67,
    "kind": "member",
    "name": "bridge",
    "memberof": "src/NativeImplement.js~ChannelNativeBridge",
    "static": false,
    "longname": "src/NativeImplement.js~ChannelNativeBridge#bridge",
    "access": "public",
    "description": null,
    "lineNumber": 25,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 68,
    "kind": "member",
    "name": "nativeBridge",
    "memberof": "src/NativeImplement.js~ChannelNativeBridge",
    "static": false,
    "longname": "src/NativeImplement.js~ChannelNativeBridge#nativeBridge",
    "access": "public",
    "description": null,
    "lineNumber": 26,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 69,
    "kind": "method",
    "name": "ready",
    "memberof": "src/NativeImplement.js~ChannelNativeBridge",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/NativeImplement.js~ChannelNativeBridge#ready",
    "access": "public",
    "description": null,
    "lineNumber": 35,
    "undocument": true,
    "params": [
      {
        "name": "args",
        "types": [
          "*"
        ]
      },
      {
        "name": "callback",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 70,
    "kind": "method",
    "name": "subscribe",
    "memberof": "src/NativeImplement.js~ChannelNativeBridge",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/NativeImplement.js~ChannelNativeBridge#subscribe",
    "access": "public",
    "description": null,
    "lineNumber": 40,
    "undocument": true,
    "params": [
      {
        "name": "arrayPattern",
        "types": [
          "*[]"
        ],
        "defaultRaw": [
          "null"
        ],
        "defaultValue": "[null]"
      },
      {
        "name": "callback",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 71,
    "kind": "method",
    "name": "unsubscribe",
    "memberof": "src/NativeImplement.js~ChannelNativeBridge",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/NativeImplement.js~ChannelNativeBridge#unsubscribe",
    "access": "public",
    "description": null,
    "lineNumber": 60,
    "undocument": true,
    "params": [
      {
        "name": "arrayPattern",
        "types": [
          "*[]"
        ],
        "defaultRaw": [
          "null"
        ],
        "defaultValue": "[null]"
      },
      {
        "name": "callback",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 72,
    "kind": "method",
    "name": "publish",
    "memberof": "src/NativeImplement.js~ChannelNativeBridge",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/NativeImplement.js~ChannelNativeBridge#publish",
    "access": "public",
    "description": null,
    "lineNumber": 76,
    "undocument": true,
    "params": [
      {
        "name": "arrayPattern",
        "types": [
          "*[]"
        ],
        "defaultRaw": [
          "null",
          "null"
        ],
        "defaultValue": "[null, null]"
      },
      {
        "name": "callback",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 73,
    "kind": "method",
    "name": "request",
    "memberof": "src/NativeImplement.js~ChannelNativeBridge",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/NativeImplement.js~ChannelNativeBridge#request",
    "access": "public",
    "description": null,
    "lineNumber": 80,
    "undocument": true,
    "params": [
      {
        "name": "arrayPattern",
        "types": [
          "*[]"
        ],
        "defaultRaw": [
          "null",
          "null"
        ],
        "defaultValue": "[null, null]"
      },
      {
        "name": "callback",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 74,
    "kind": "file",
    "name": "src/WebImplement.js",
    "content": "import { \n    CHANNEL, \n    CHANNEL_MESSAGE, \n    CHANNEL_CONNECT_STATUS_CHANGE, \n    CHANNEL_CONNECT_STATUS_CONNECTED,\n    CHANNEL_CONNECT_STATUS_DISCONNECTED\n} from './constants';\nimport EventEmitter from '@bone/event-emitter';\nimport logger from '@bone/logger';\nimport Paho from '@bone/paho-client';\n\nconst SYMBOL_CLIENT = Symbol('client');\nconst SYMBOL_OPTIONS = Symbol('options');\n\nconst log = logger.create({\n    module: 'ChannelWebImpl',\n    label: ['Bone', 'channel']\n});\n\n// @todo\nconst HOST = {\n    development: 'ws://channel.iot-as-mqtt.cn-shanghai.aliyuncs.com:8883/',\n    test: 'ws://channel.iot-as-mqtt.cn-shanghai.aliyuncs.com:443/',\n    production: 'ws://channel.iot-as-mqtt.cn-shanghai.aliyuncs.com:443/'\n};\n\nconst RANDOM_RANGE = Math.pow(2, 64);\nfunction createRandom(){\n    return Math.floor(Math.random() * RANDOM_RANGE);\n}\n\nconst UA = (function(){\n    const ua = navigator.userAgent.toLowerCase();\n    const match = /(chrome)[ \\/](\\w+)\\./.exec( ua ) ||\n        /(webkit)[ \\/]([\\w.]+)/.exec( ua ) ||\n        /(opera)(?:.*version|)[ \\/](\\w+)\\./.exec( ua ) ||\n        /(msie) ([\\w.]+)/.exec( ua ) ||\n        ua.indexOf(\"compatible\") < 0 && /(mozilla)(?:.*? rv:(\\w+)\\.|)/.exec( ua ) ||\n        [];\n    \n    // format: browser_version\n    const browser = match[1] || 'unknown';\n    const version = match[2] || '0';\n    \n    return browser + '_' + version;\n})();\n\nconst DELIVER_PREFIX = '_ON_MESSAGE_DELIVERED_';\n\nclass ChannelWebBridge {\n    static moduleName = CHANNEL;\n    \n    constructor({\n        bridge\n    }){\n        // mixin event-emitter for event dispatching\n        Object.assign(this, EventEmitter);\n        this.bridge = bridge;\n    }\n\n    // fake ready\n    // it's useful for web initialization\n    ready([conf], callback){\n        const {\n            // IoT ID\n            id,\n            // IoT token\n            token\n        } = conf;\n\n        // ready\n        if(this.client){\n            callback(new Error('channel: duplicate ready'));\n            return;\n        }\n\n        if(typeof id !== 'string'){\n            callback(new Error('channel: id is required'));\n            return;\n        }\n\n        if(typeof token !== 'string'){\n            callback(new Error('channel: token is required'));\n            return;\n        }\n\n        const env = this.env = process && process.env && process.env.NODE_ENV ? process.env.NODE_ENV : 'production';\n        const host = this.host = HOST[env];\n\n        log.debug(`ready: id=${id}, token=${token}, env=${env}, host=${host}`);\n\n        const random = createRandom();\n        const clientId = `${id}_${random}&${UA}`;\n        const mqttClientId = `${clientId}|securemode=2,authtype=sepauth|`;\n        const topicPrefix = `/sys/${UA}/${id}_${random}/web/`;\n        const clientOptions = {\n            host: HOST[env],\n            clientId,\n            mqttClientId,\n            mqttUsername: clientId,\n            mqttPassword: token,\n            topicPrefix\n        };\n\n        log.debug('ready: create client', clientOptions);\n        const client = this.client = new ClientWrapper(clientOptions);\n\n        // delegate event\n        client\n            .on(CHANNEL_CONNECT_STATUS_CHANGE, (...args)=>{\n                this.emit(CHANNEL_CONNECT_STATUS_CHANGE, ...args);\n            })\n            .connect()\n                .then(\n                    onConnect.bind(this),\n                    onConnectFailed.bind(this)\n               )\n               .catch(onConnectFailed.bind(this));\n\n        function onConnect(...args){\n            log.debug(`ready: connected`);\n            client._subscribeDefaultTopic((err)=>{\n                if(err){\n                    log.warn(`ready: subscribe default topic failed`, err);\n                    callback(err);\n                    return;\n                }\n\n                log.debug(`ready: subscribe default topic success`);\n                callback(null);\n            });\n        }\n\n        function onConnectFailed(err){\n            log.warn(`ready: connect failed`, err);\n            callback(err);\n        }\n    }\n\n    subscribe([topic], callback){\n        this.client.on(topic, callback);\n    }\n\n    unsubscribe([topic], callback){\n        this.client.off(topic, callback);\n    }\n\n    publish([topic, payload], callback){\n        this.client.publish([topic, payload], callback);\n    }\n\n    request([topic, payload], callback){\n        this.client.request([topic, payload], callback);\n    }\n}\n\nclass ClientWrapper {\n    get client(){\n        return this[SYMBOL_CLIENT];\n    }\n\n    get host(){\n        return this[SYMBOL_OPTIONS].host;\n    }\n\n    get clientId(){\n        return this[SYMBOL_OPTIONS].clientId;\n    }\n\n    get mqttClientId(){\n        return this[SYMBOL_OPTIONS].mqttClientId;\n    }\n\n    get mqttUsername(){\n        return this[SYMBOL_OPTIONS].mqttUsername;\n    }\n\n    get mqttPassword(){\n        return this[SYMBOL_OPTIONS].mqttPassword;\n    }\n\n    get topicPrefix(){\n        return this[SYMBOL_OPTIONS].topicPrefix;\n    }\n\n    constructor({\n        host,\n        clientId,\n        mqttClientId,\n        mqttUsername,\n        mqttPassword,\n        topicPrefix\n    }){\n        log.debug('client.constructor in:', {\n            host,\n            clientId,\n            mqttClientId,\n            mqttUsername,\n            mqttPassword,\n            topicPrefix \n        });\n        \n        // mixin event-emitter\n        Object.assign(this, EventEmitter);\n\n        // create client\n        const client = this[SYMBOL_CLIENT] = new Paho.Client(host, mqttClientId);\n        log.debug('client.constructor: client created', client);\n\n        // keep options\n        this[SYMBOL_OPTIONS] = { host, clientId, mqttClientId, mqttUsername, mqttPassword, topicPrefix };\n\n        // common message handler\n        client.onMessageArrived = this._onMessageArrived.bind(this);\n\n        // no need for deliver event\n        client.onMessageDelivered = this._onMessageDelivered.bind(this);\n\n        // connect status change\n        client.onConnected = this._onConnected.bind(this);\n        client.onConnectionLost = this._onConnectionLost.bind(this);\n    }\n\n    connect(){\n        log.debug('client.connect: connecting client');\n        return new Promise((resolve, reject)=>{\n            // @see http://www.eclipse.org/paho/files/jsdoc/Paho.MQTT.Client.html\n            const options = {\n                useSSL: true,\n                userName: this.mqttUsername,\n                password: this.mqttPassword,\n                // default timeout is 30s\n                // timeout: 30, \n                // default keep-alive interval is 60s\n                // keepAliveInterval: 60,\n                reconnect: true,\n                onSuccess: resolve,\n                onFailure: reject\n            };\n    \n            log.debug('client.connect options:', options);\n            // connect the client\n            this.client.connect(options);\n        });\n    }\n\n    _subscribeDefaultTopic(callback){\n        log.debug(`client._subscribeDefaultTopic: ${this.topicPrefix}down/#`);\n\n        // subscribe default topics\n        this.client.subscribe(`${this.topicPrefix}down/#`, {\n            // qos is meaningles in client\n            qos: 0,\n            onSuccess: ()=>{\n                // do nothing\n                log.debug(`client.connect: default topic '${this.topicPrefix}down/#' subscribed`);\n                callback(null);\n            },\n            onFailure: (err)=>{\n                log.warn(`client.connect: default topic '${this.topicPrefix}down/#' subscribed failed`);\n                callback(err);\n            }\n        });\n    }\n\n    /**\n     * @private\n     * @param {Paho.MQTT.Message} msg \n     */\n    _onMessageArrived(rawMsg){\n        log.debug('client message received:', rawMsg);\n\n        const topic = rawMsg.destinationName.replace(/^\\/sys\\/[^\\/]+\\/[^\\/]+\\/web\\/down/, '');\n        const msg = { topic };\n        try {\n            msg.payload = JSON.parse(rawMsg.payloadString);\n        } catch(err){\n            log.error('client message parse error:', err.message);\n            return;\n        }\n\n        this.emit(topic, msg);\n    }\n\n    _onMessageDelivered(msg){\n        log.debug('client message delivered:', msg);\n\n        const topic = DELIVER_PREFIX + msg.destinationName.replace(/^\\/sys\\/[^\\/]+\\/[^\\/]+\\/web\\/up/, '');\n        this.emit(topic, msg);\n    }\n\n    _onConnected(){\n        this.emit(CHANNEL_CONNECT_STATUS_CHANGE, CHANNEL_CONNECT_STATUS_CONNECTED);\n    }\n\n    _onConnectionLost(err){\n        log.warn('client connection lost:', err);\n        this.emit(CHANNEL_CONNECT_STATUS_CHANGE, CHANNEL_CONNECT_STATUS_DISCONNECTED, err);\n    }\n\n    publish([topic, payload, qos=0, retained=true], callback){\n        log.debug('client.publish:', `${this.topicPrefix}up${topic}`, payload, qos, retained);\n\n        try{\n            typeof payload === 'object' && (payload = JSON.stringify(payload));\n        }catch(err){\n            log.warn('client.publish error:', err);\n            callback(err);\n            return;\n        }\n\n        // bind callback on deliver event\n        typeof callback === 'function' && this.one(DELIVER_PREFIX + topic, (...args)=>{\n            callback(null, ...args);\n        });\n\n        this.client.publish(`${this.topicPrefix}up${topic}`, payload, qos, retained);\n    }\n\n    request([topic, payload, qos=0, retained=true], callback){\n        log.debug('client.request:', `${this.topicPrefix}up${topic}`, payload, qos, retained);\n        \n        this.publish([topic, payload], (err)=>{\n            if(err){\n                callback(err);\n                return;\n            }\n\n            // publish successfully\n            // subscribe reply topic\n            typeof callback === 'function' && this.one(topic + '_reply', (msg)=>{\n                callback(null, msg);\n            });\n        });\n    }\n}\n\nexport default ChannelWebBridge;",
    "static": true,
    "longname": "/Users/NicolasWan/Desktop/WorkSpace/JavaScript/aliplus/bone/channel/src/WebImplement.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 75,
    "kind": "variable",
    "name": "SYMBOL_CLIENT",
    "memberof": "src/WebImplement.js",
    "static": true,
    "longname": "src/WebImplement.js~SYMBOL_CLIENT",
    "access": "public",
    "export": false,
    "importPath": "@bone/channel/src/WebImplement.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 12,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 76,
    "kind": "variable",
    "name": "SYMBOL_OPTIONS",
    "memberof": "src/WebImplement.js",
    "static": true,
    "longname": "src/WebImplement.js~SYMBOL_OPTIONS",
    "access": "public",
    "export": false,
    "importPath": "@bone/channel/src/WebImplement.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 13,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 77,
    "kind": "variable",
    "name": "log",
    "memberof": "src/WebImplement.js",
    "static": true,
    "longname": "src/WebImplement.js~log",
    "access": "public",
    "export": false,
    "importPath": "@bone/channel/src/WebImplement.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 15,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 78,
    "kind": "variable",
    "name": "HOST",
    "memberof": "src/WebImplement.js",
    "static": true,
    "longname": "src/WebImplement.js~HOST",
    "access": "public",
    "export": false,
    "importPath": "@bone/channel/src/WebImplement.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 21,
    "undocument": true,
    "type": {
      "types": [
        "{\"development\": string, \"test\": string, \"production\": string}"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 79,
    "kind": "variable",
    "name": "RANDOM_RANGE",
    "memberof": "src/WebImplement.js",
    "static": true,
    "longname": "src/WebImplement.js~RANDOM_RANGE",
    "access": "public",
    "export": false,
    "importPath": "@bone/channel/src/WebImplement.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 27,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 80,
    "kind": "function",
    "name": "createRandom",
    "memberof": "src/WebImplement.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/WebImplement.js~createRandom",
    "access": "public",
    "export": false,
    "importPath": "@bone/channel/src/WebImplement.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 28,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 81,
    "kind": "variable",
    "name": "UA",
    "memberof": "src/WebImplement.js",
    "static": true,
    "longname": "src/WebImplement.js~UA",
    "access": "public",
    "export": false,
    "importPath": "@bone/channel/src/WebImplement.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 32,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 82,
    "kind": "variable",
    "name": "DELIVER_PREFIX",
    "memberof": "src/WebImplement.js",
    "static": true,
    "longname": "src/WebImplement.js~DELIVER_PREFIX",
    "access": "public",
    "export": false,
    "importPath": "@bone/channel/src/WebImplement.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 48,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 83,
    "kind": "class",
    "name": "ClientWrapper",
    "memberof": "src/WebImplement.js",
    "static": true,
    "longname": "src/WebImplement.js~ClientWrapper",
    "access": "public",
    "export": false,
    "importPath": "@bone/channel/src/WebImplement.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 157,
    "undocument": true,
    "interface": false,
    "ignore": true
  },
  {
    "__docId__": 84,
    "kind": "get",
    "name": "client",
    "memberof": "src/WebImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebImplement.js~ClientWrapper#client",
    "access": "public",
    "description": null,
    "lineNumber": 158,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 85,
    "kind": "get",
    "name": "host",
    "memberof": "src/WebImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebImplement.js~ClientWrapper#host",
    "access": "public",
    "description": null,
    "lineNumber": 162,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 86,
    "kind": "get",
    "name": "clientId",
    "memberof": "src/WebImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebImplement.js~ClientWrapper#clientId",
    "access": "public",
    "description": null,
    "lineNumber": 166,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 87,
    "kind": "get",
    "name": "mqttClientId",
    "memberof": "src/WebImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebImplement.js~ClientWrapper#mqttClientId",
    "access": "public",
    "description": null,
    "lineNumber": 170,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 88,
    "kind": "get",
    "name": "mqttUsername",
    "memberof": "src/WebImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebImplement.js~ClientWrapper#mqttUsername",
    "access": "public",
    "description": null,
    "lineNumber": 174,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 89,
    "kind": "get",
    "name": "mqttPassword",
    "memberof": "src/WebImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebImplement.js~ClientWrapper#mqttPassword",
    "access": "public",
    "description": null,
    "lineNumber": 178,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 90,
    "kind": "get",
    "name": "topicPrefix",
    "memberof": "src/WebImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebImplement.js~ClientWrapper#topicPrefix",
    "access": "public",
    "description": null,
    "lineNumber": 182,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 91,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "src/WebImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebImplement.js~ClientWrapper#constructor",
    "access": "public",
    "description": null,
    "lineNumber": 186,
    "undocument": true
  },
  {
    "__docId__": 92,
    "kind": "member",
    "name": "[SYMBOL_OPTIONS]",
    "memberof": "src/WebImplement.js~ClientWrapper",
    "static": false,
    "longname": "src/WebImplement.js~ClientWrapper#[SYMBOL_OPTIONS]",
    "access": "public",
    "description": null,
    "lineNumber": 211,
    "undocument": true,
    "type": {
      "types": [
        "{\"host\": *, \"clientId\": *, \"mqttClientId\": *, \"mqttUsername\": *, \"mqttPassword\": *, \"topicPrefix\": *}"
      ]
    }
  },
  {
    "__docId__": 93,
    "kind": "method",
    "name": "connect",
    "memberof": "src/WebImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebImplement.js~ClientWrapper#connect",
    "access": "public",
    "description": null,
    "lineNumber": 224,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 94,
    "kind": "method",
    "name": "_subscribeDefaultTopic",
    "memberof": "src/WebImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebImplement.js~ClientWrapper#_subscribeDefaultTopic",
    "access": "private",
    "description": null,
    "lineNumber": 247,
    "undocument": true,
    "params": [
      {
        "name": "callback",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 95,
    "kind": "method",
    "name": "_onMessageArrived",
    "memberof": "src/WebImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebImplement.js~ClientWrapper#_onMessageArrived",
    "access": "private",
    "description": "",
    "lineNumber": 270,
    "params": [
      {
        "nullable": null,
        "types": [
          "Paho.MQTT.Message"
        ],
        "spread": false,
        "optional": false,
        "name": "msg",
        "description": ""
      }
    ],
    "return": null
  },
  {
    "__docId__": 96,
    "kind": "method",
    "name": "_onMessageDelivered",
    "memberof": "src/WebImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebImplement.js~ClientWrapper#_onMessageDelivered",
    "access": "private",
    "description": null,
    "lineNumber": 285,
    "undocument": true,
    "params": [
      {
        "name": "msg",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 97,
    "kind": "method",
    "name": "_onConnected",
    "memberof": "src/WebImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebImplement.js~ClientWrapper#_onConnected",
    "access": "private",
    "description": null,
    "lineNumber": 292,
    "undocument": true,
    "params": [],
    "return": null
  },
  {
    "__docId__": 98,
    "kind": "method",
    "name": "_onConnectionLost",
    "memberof": "src/WebImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebImplement.js~ClientWrapper#_onConnectionLost",
    "access": "private",
    "description": null,
    "lineNumber": 296,
    "undocument": true,
    "params": [
      {
        "name": "err",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 99,
    "kind": "method",
    "name": "publish",
    "memberof": "src/WebImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebImplement.js~ClientWrapper#publish",
    "access": "public",
    "description": null,
    "lineNumber": 301,
    "undocument": true,
    "params": [
      {
        "name": "arrayPattern",
        "types": [
          "number[]"
        ],
        "defaultRaw": [
          "null",
          "null",
          "0",
          "true"
        ],
        "defaultValue": "[null, null, 0, true]"
      },
      {
        "name": "callback",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 100,
    "kind": "method",
    "name": "request",
    "memberof": "src/WebImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebImplement.js~ClientWrapper#request",
    "access": "public",
    "description": null,
    "lineNumber": 320,
    "undocument": true,
    "params": [
      {
        "name": "arrayPattern",
        "types": [
          "number[]"
        ],
        "defaultRaw": [
          "null",
          "null",
          "0",
          "true"
        ],
        "defaultValue": "[null, null, 0, true]"
      },
      {
        "name": "callback",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 101,
    "kind": "class",
    "name": "ChannelWebBridge",
    "memberof": "src/WebImplement.js",
    "static": true,
    "longname": "src/WebImplement.js~ChannelWebBridge",
    "access": "public",
    "export": true,
    "importPath": "@bone/channel/src/WebImplement.js",
    "importStyle": "ChannelWebBridge",
    "description": null,
    "lineNumber": 50,
    "undocument": true,
    "interface": false
  },
  {
    "__docId__": 102,
    "kind": "member",
    "name": "moduleName",
    "memberof": "src/WebImplement.js~ChannelWebBridge",
    "static": true,
    "longname": "src/WebImplement.js~ChannelWebBridge.moduleName",
    "access": "public",
    "description": null,
    "lineNumber": 51,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 103,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "src/WebImplement.js~ChannelWebBridge",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebImplement.js~ChannelWebBridge#constructor",
    "access": "public",
    "description": null,
    "lineNumber": 53,
    "undocument": true
  },
  {
    "__docId__": 104,
    "kind": "member",
    "name": "bridge",
    "memberof": "src/WebImplement.js~ChannelWebBridge",
    "static": false,
    "longname": "src/WebImplement.js~ChannelWebBridge#bridge",
    "access": "public",
    "description": null,
    "lineNumber": 58,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 105,
    "kind": "method",
    "name": "ready",
    "memberof": "src/WebImplement.js~ChannelWebBridge",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebImplement.js~ChannelWebBridge#ready",
    "access": "public",
    "description": null,
    "lineNumber": 63,
    "undocument": true,
    "params": [
      {
        "name": "arrayPattern",
        "types": [
          "*[]"
        ],
        "defaultRaw": [
          "null"
        ],
        "defaultValue": "[null]"
      },
      {
        "name": "callback",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 106,
    "kind": "method",
    "name": "subscribe",
    "memberof": "src/WebImplement.js~ChannelWebBridge",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebImplement.js~ChannelWebBridge#subscribe",
    "access": "public",
    "description": null,
    "lineNumber": 140,
    "undocument": true,
    "params": [
      {
        "name": "arrayPattern",
        "types": [
          "*[]"
        ],
        "defaultRaw": [
          "null"
        ],
        "defaultValue": "[null]"
      },
      {
        "name": "callback",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 107,
    "kind": "method",
    "name": "unsubscribe",
    "memberof": "src/WebImplement.js~ChannelWebBridge",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebImplement.js~ChannelWebBridge#unsubscribe",
    "access": "public",
    "description": null,
    "lineNumber": 144,
    "undocument": true,
    "params": [
      {
        "name": "arrayPattern",
        "types": [
          "*[]"
        ],
        "defaultRaw": [
          "null"
        ],
        "defaultValue": "[null]"
      },
      {
        "name": "callback",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 108,
    "kind": "method",
    "name": "publish",
    "memberof": "src/WebImplement.js~ChannelWebBridge",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebImplement.js~ChannelWebBridge#publish",
    "access": "public",
    "description": null,
    "lineNumber": 148,
    "undocument": true,
    "params": [
      {
        "name": "arrayPattern",
        "types": [
          "*[]"
        ],
        "defaultRaw": [
          "null",
          "null"
        ],
        "defaultValue": "[null, null]"
      },
      {
        "name": "callback",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 109,
    "kind": "method",
    "name": "request",
    "memberof": "src/WebImplement.js~ChannelWebBridge",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebImplement.js~ChannelWebBridge#request",
    "access": "public",
    "description": null,
    "lineNumber": 152,
    "undocument": true,
    "params": [
      {
        "name": "arrayPattern",
        "types": [
          "*[]"
        ],
        "defaultRaw": [
          "null",
          "null"
        ],
        "defaultValue": "[null, null]"
      },
      {
        "name": "callback",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 110,
    "kind": "file",
    "name": "src/WebSimulatorImplement.js",
    "content": "import { \n    CHANNEL, \n    CHANNEL_MESSAGE, \n    CHANNEL_CONNECT_STATUS_CHANGE, \n    CHANNEL_CONNECT_STATUS_CONNECTED,\n    CHANNEL_CONNECT_STATUS_DISCONNECTED\n} from './constants';\nimport EventEmitter from '@bone/event-emitter';\nimport logger from '@bone/logger';\nimport Paho from '@bone/paho-client';\n\nconst SYMBOL_CLIENT = Symbol('client');\nconst SYMBOL_OPTIONS = Symbol('options');\n\nconst log = logger.create({\n    module: 'ChannelWebImpl',\n    label: ['Bone', 'channel']\n});\n\n// @todo\nconst HOST = {\n    development: 'ws://channel.iot-as-mqtt.cn-shanghai.aliyuncs.com:8883/',\n    test: 'ws://channel.iot-as-mqtt.cn-shanghai.aliyuncs.com:443/',\n    production: 'ws://channel.iot-as-mqtt.cn-shanghai.aliyuncs.com:443/'\n};\n\nconst UA = (function(){\n    const ua = navigator.userAgent.toLowerCase();\n    const match = /(chrome)[ \\/](\\w+)\\./.exec( ua ) ||\n        /(webkit)[ \\/]([\\w.]+)/.exec( ua ) ||\n        /(opera)(?:.*version|)[ \\/](\\w+)\\./.exec( ua ) ||\n        /(msie) ([\\w.]+)/.exec( ua ) ||\n        ua.indexOf(\"compatible\") < 0 && /(mozilla)(?:.*? rv:(\\w+)\\.|)/.exec( ua ) ||\n        [];\n    \n    // format: browser_version\n    const browser = match[1] || 'unknown';\n    const version = match[2] || '0';\n    \n    return browser + '_' + version;\n})();\n\nconst DELIVER_PREFIX = '_ON_MESSAGE_DELIVERED_';\n\nclass ChannelWebBridge {\n    static moduleName = CHANNEL;\n    \n    constructor({\n        bridge\n    }){\n        // mixin event-emitter for event dispatching\n        Object.assign(this, EventEmitter);\n        this.bridge = bridge;\n        this.mqttOptions = {};\n    }\n\n    // fake ready\n    // it's useful for web initialization\n    ready([conf], callback) {\n        callback = callback || function() { };\n        const { clientId, mqttClientId, mqttUsername, mqttPassword, topicRoot } = this.mqttOptions;\n        const topicPrefix = topicRoot;\n\n        // ready\n        if(this.client){\n            callback(null);\n            return;\n        }\n\n        const validProps = ['clientId', 'mqttClientId', 'mqttUsername', 'mqttPassword', 'topicRoot'];\n        for (var i = 0; i < validProps.length; ++i) {\n            if (typeof this.mqttOptions[validProps[i]] !== 'string') {\n                callback(new Error(`channel: ${validProps[i]} is required`));\n                return;\n            }\n        }\n\n        const env = this.env || 'production';\n        const host = this.host = HOST[env];\n        \n        const clientOptions = {\n            host: HOST[env],\n            clientId,\n            mqttClientId,\n            mqttUsername,\n            mqttPassword,\n            topicPrefix\n        };\n\n        log.debug('ready: create client', clientOptions);\n        const client = this.client = new ClientWrapper(clientOptions);\n\n        // delegate event\n        client\n            .on(CHANNEL_CONNECT_STATUS_CHANGE, (...args)=>{\n                this.emit(CHANNEL_CONNECT_STATUS_CHANGE, ...args);\n            })\n            .connect()\n                .then(\n                    onConnect.bind(this),\n                    onConnectFailed.bind(this)\n               )\n               .catch(onConnectFailed.bind(this));\n\n        function onConnect(...args){\n            log.debug(`ready: connected`);\n            client._subscribeDefaultTopic((err)=>{\n                if(err){\n                    log.warn(`ready: subscribe default topic failed`, err);\n                    callback(err);\n                    return;\n                }\n\n                log.debug(`ready: subscribe default topic success`);\n                callback(null);\n            });\n        }\n\n        function onConnectFailed(err){\n            log.warn(`ready: connect failed`, err);\n            callback(err);\n        }\n    }\n\n    subscribe([topic], callback){\n        this.client.on(topic, callback);\n    }\n\n    unsubscribe([topic], callback){\n        this.client.off(topic, callback);\n    }\n\n    publish([topic, payload], callback){\n        this.client.publish([topic, payload], callback);\n    }\n\n    request([topic, payload], callback){\n        this.client.request([topic, payload], callback);\n    }\n}\n\nclass ClientWrapper {\n    get client(){\n        return this[SYMBOL_CLIENT];\n    }\n\n    get host(){\n        return this[SYMBOL_OPTIONS].host;\n    }\n\n    get clientId(){\n        return this[SYMBOL_OPTIONS].clientId;\n    }\n\n    get mqttClientId(){\n        return this[SYMBOL_OPTIONS].mqttClientId;\n    }\n\n    get mqttUsername(){\n        return this[SYMBOL_OPTIONS].mqttUsername;\n    }\n\n    get mqttPassword(){\n        return this[SYMBOL_OPTIONS].mqttPassword;\n    }\n\n    get topicPrefix(){\n        return this[SYMBOL_OPTIONS].topicPrefix;\n    }\n\n    constructor({\n        host,\n        clientId,\n        mqttClientId,\n        mqttUsername,\n        mqttPassword,\n        topicPrefix\n    }){\n        log.debug('client.constructor in:', {\n            host,\n            clientId,\n            mqttClientId,\n            mqttUsername,\n            mqttPassword,\n            topicPrefix \n        });\n        \n        // mixin event-emitter\n        Object.assign(this, EventEmitter);\n\n        // create client\n        const client = this[SYMBOL_CLIENT] = new Paho.Client(host, mqttClientId);\n        log.debug('client.constructor: client created', client);\n\n        // keep options\n        this[SYMBOL_OPTIONS] = { host, clientId, mqttClientId, mqttUsername, mqttPassword, topicPrefix };\n\n        // common message handler\n        client.onMessageArrived = this._onMessageArrived.bind(this);\n\n        // no need for deliver event\n        client.onMessageDelivered = this._onMessageDelivered.bind(this);\n\n        // connect status change\n        client.onConnected = this._onConnected.bind(this);\n        client.onConnectionLost = this._onConnectionLost.bind(this);\n    }\n\n    connect(){\n        log.debug('client.connect: connecting client');\n        return new Promise((resolve, reject)=>{\n            // @see http://www.eclipse.org/paho/files/jsdoc/Paho.MQTT.Client.html\n            const options = {\n                useSSL: true,\n                userName: this.mqttUsername,\n                password: this.mqttPassword,\n                // default timeout is 30s\n                // timeout: 30, \n                // default keep-alive interval is 60s\n                // keepAliveInterval: 60,\n                reconnect: true,\n                onSuccess: resolve,\n                onFailure: reject\n            };\n    \n            log.debug('client.connect options:', options);\n            // connect the client\n            this.client.connect(options);\n        });\n    }\n\n    _subscribeDefaultTopic(callback){\n        log.debug(`client._subscribeDefaultTopic: ${this.topicPrefix}down/#`);\n\n        // subscribe default topics\n        this.client.subscribe(`${this.topicPrefix}down/#`, {\n            // qos is meaningles in client\n            qos: 0,\n            onSuccess: ()=>{\n                // do nothing\n                log.debug(`client.connect: default topic '${this.topicPrefix}down/#' subscribed`);\n                callback(null);\n            },\n            onFailure: (err)=>{\n                log.warn(`client.connect: default topic '${this.topicPrefix}down/#' subscribed failed`);\n                callback(err);\n            }\n        });\n    }\n\n    /**\n     * @private\n     * @param {Paho.MQTT.Message} msg \n     */\n    _onMessageArrived(rawMsg){\n        log.debug('client message received:', rawMsg);\n\n        const topic = rawMsg.destinationName.replace(/^\\/sys\\/[^\\/]+\\/[^\\/]+\\/app\\/down/, '');\n        const msg = { topic };\n        try {\n            msg.payload = JSON.parse(rawMsg.payloadString);\n        } catch(err){\n            log.error('client message parse error:', err.message);\n            return;\n        }\n\n        this.emit(topic, msg);\n    }\n\n    _onMessageDelivered(msg){\n        log.debug('client message delivered:', msg);\n\n        const topic = DELIVER_PREFIX + msg.destinationName.replace(/^\\/sys\\/[^\\/]+\\/[^\\/]+\\/app\\/up/, '');\n        this.emit(topic, msg);\n    }\n\n    _onConnected(){\n        this.emit(CHANNEL_CONNECT_STATUS_CHANGE, CHANNEL_CONNECT_STATUS_CONNECTED);\n    }\n\n    _onConnectionLost(err){\n        log.warn('client connection lost:', err);\n        this.emit(CHANNEL_CONNECT_STATUS_CHANGE, CHANNEL_CONNECT_STATUS_DISCONNECTED, err);\n    }\n\n    publish([topic, payload, qos=0, retained=true], callback){\n        log.debug('client.publish:', `${this.topicPrefix}up${topic}`, payload, qos, retained);\n\n        try{\n            typeof payload === 'object' && (payload = JSON.stringify(payload));\n        }catch(err){\n            log.warn('client.publish error:', err);\n            callback(err);\n            return;\n        }\n\n        // bind callback on deliver event\n        typeof callback === 'function' && this.one(DELIVER_PREFIX + topic, (...args)=>{\n            callback(null, ...args);\n        });\n\n        this.client.publish(`${this.topicPrefix}up${topic}`, payload, qos, retained);\n    }\n\n    request([topic, payload, qos=0, retained=true], callback){\n        log.debug('client.request:', `${this.topicPrefix}up${topic}`, payload, qos, retained);\n        \n        this.publish([topic, payload], (err)=>{\n            if(err){\n                callback(err);\n                return;\n            }\n\n            // publish successfully\n            // subscribe reply topic\n            typeof callback === 'function' && this.one(topic + '_reply', (msg)=>{\n                callback(null, msg);\n            });\n        });\n    }\n}\n\nexport default ChannelWebBridge;",
    "static": true,
    "longname": "/Users/NicolasWan/Desktop/WorkSpace/JavaScript/aliplus/bone/channel/src/WebSimulatorImplement.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 111,
    "kind": "variable",
    "name": "SYMBOL_CLIENT",
    "memberof": "src/WebSimulatorImplement.js",
    "static": true,
    "longname": "src/WebSimulatorImplement.js~SYMBOL_CLIENT",
    "access": "public",
    "export": false,
    "importPath": "@bone/channel/src/WebSimulatorImplement.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 12,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 112,
    "kind": "variable",
    "name": "SYMBOL_OPTIONS",
    "memberof": "src/WebSimulatorImplement.js",
    "static": true,
    "longname": "src/WebSimulatorImplement.js~SYMBOL_OPTIONS",
    "access": "public",
    "export": false,
    "importPath": "@bone/channel/src/WebSimulatorImplement.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 13,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 113,
    "kind": "variable",
    "name": "log",
    "memberof": "src/WebSimulatorImplement.js",
    "static": true,
    "longname": "src/WebSimulatorImplement.js~log",
    "access": "public",
    "export": false,
    "importPath": "@bone/channel/src/WebSimulatorImplement.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 15,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 114,
    "kind": "variable",
    "name": "HOST",
    "memberof": "src/WebSimulatorImplement.js",
    "static": true,
    "longname": "src/WebSimulatorImplement.js~HOST",
    "access": "public",
    "export": false,
    "importPath": "@bone/channel/src/WebSimulatorImplement.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 21,
    "undocument": true,
    "type": {
      "types": [
        "{\"development\": string, \"test\": string, \"production\": string}"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 115,
    "kind": "variable",
    "name": "UA",
    "memberof": "src/WebSimulatorImplement.js",
    "static": true,
    "longname": "src/WebSimulatorImplement.js~UA",
    "access": "public",
    "export": false,
    "importPath": "@bone/channel/src/WebSimulatorImplement.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 27,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 116,
    "kind": "variable",
    "name": "DELIVER_PREFIX",
    "memberof": "src/WebSimulatorImplement.js",
    "static": true,
    "longname": "src/WebSimulatorImplement.js~DELIVER_PREFIX",
    "access": "public",
    "export": false,
    "importPath": "@bone/channel/src/WebSimulatorImplement.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 43,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 117,
    "kind": "class",
    "name": "ClientWrapper",
    "memberof": "src/WebSimulatorImplement.js",
    "static": true,
    "longname": "src/WebSimulatorImplement.js~ClientWrapper",
    "access": "public",
    "export": false,
    "importPath": "@bone/channel/src/WebSimulatorImplement.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 142,
    "undocument": true,
    "interface": false,
    "ignore": true
  },
  {
    "__docId__": 118,
    "kind": "get",
    "name": "client",
    "memberof": "src/WebSimulatorImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebSimulatorImplement.js~ClientWrapper#client",
    "access": "public",
    "description": null,
    "lineNumber": 143,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 119,
    "kind": "get",
    "name": "host",
    "memberof": "src/WebSimulatorImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebSimulatorImplement.js~ClientWrapper#host",
    "access": "public",
    "description": null,
    "lineNumber": 147,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 120,
    "kind": "get",
    "name": "clientId",
    "memberof": "src/WebSimulatorImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebSimulatorImplement.js~ClientWrapper#clientId",
    "access": "public",
    "description": null,
    "lineNumber": 151,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 121,
    "kind": "get",
    "name": "mqttClientId",
    "memberof": "src/WebSimulatorImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebSimulatorImplement.js~ClientWrapper#mqttClientId",
    "access": "public",
    "description": null,
    "lineNumber": 155,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 122,
    "kind": "get",
    "name": "mqttUsername",
    "memberof": "src/WebSimulatorImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebSimulatorImplement.js~ClientWrapper#mqttUsername",
    "access": "public",
    "description": null,
    "lineNumber": 159,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 123,
    "kind": "get",
    "name": "mqttPassword",
    "memberof": "src/WebSimulatorImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebSimulatorImplement.js~ClientWrapper#mqttPassword",
    "access": "public",
    "description": null,
    "lineNumber": 163,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 124,
    "kind": "get",
    "name": "topicPrefix",
    "memberof": "src/WebSimulatorImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebSimulatorImplement.js~ClientWrapper#topicPrefix",
    "access": "public",
    "description": null,
    "lineNumber": 167,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 125,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "src/WebSimulatorImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebSimulatorImplement.js~ClientWrapper#constructor",
    "access": "public",
    "description": null,
    "lineNumber": 171,
    "undocument": true
  },
  {
    "__docId__": 126,
    "kind": "member",
    "name": "[SYMBOL_OPTIONS]",
    "memberof": "src/WebSimulatorImplement.js~ClientWrapper",
    "static": false,
    "longname": "src/WebSimulatorImplement.js~ClientWrapper#[SYMBOL_OPTIONS]",
    "access": "public",
    "description": null,
    "lineNumber": 196,
    "undocument": true,
    "type": {
      "types": [
        "{\"host\": *, \"clientId\": *, \"mqttClientId\": *, \"mqttUsername\": *, \"mqttPassword\": *, \"topicPrefix\": *}"
      ]
    }
  },
  {
    "__docId__": 127,
    "kind": "method",
    "name": "connect",
    "memberof": "src/WebSimulatorImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebSimulatorImplement.js~ClientWrapper#connect",
    "access": "public",
    "description": null,
    "lineNumber": 209,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 128,
    "kind": "method",
    "name": "_subscribeDefaultTopic",
    "memberof": "src/WebSimulatorImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebSimulatorImplement.js~ClientWrapper#_subscribeDefaultTopic",
    "access": "private",
    "description": null,
    "lineNumber": 232,
    "undocument": true,
    "params": [
      {
        "name": "callback",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 129,
    "kind": "method",
    "name": "_onMessageArrived",
    "memberof": "src/WebSimulatorImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebSimulatorImplement.js~ClientWrapper#_onMessageArrived",
    "access": "private",
    "description": "",
    "lineNumber": 255,
    "params": [
      {
        "nullable": null,
        "types": [
          "Paho.MQTT.Message"
        ],
        "spread": false,
        "optional": false,
        "name": "msg",
        "description": ""
      }
    ],
    "return": null
  },
  {
    "__docId__": 130,
    "kind": "method",
    "name": "_onMessageDelivered",
    "memberof": "src/WebSimulatorImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebSimulatorImplement.js~ClientWrapper#_onMessageDelivered",
    "access": "private",
    "description": null,
    "lineNumber": 270,
    "undocument": true,
    "params": [
      {
        "name": "msg",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 131,
    "kind": "method",
    "name": "_onConnected",
    "memberof": "src/WebSimulatorImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebSimulatorImplement.js~ClientWrapper#_onConnected",
    "access": "private",
    "description": null,
    "lineNumber": 277,
    "undocument": true,
    "params": [],
    "return": null
  },
  {
    "__docId__": 132,
    "kind": "method",
    "name": "_onConnectionLost",
    "memberof": "src/WebSimulatorImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebSimulatorImplement.js~ClientWrapper#_onConnectionLost",
    "access": "private",
    "description": null,
    "lineNumber": 281,
    "undocument": true,
    "params": [
      {
        "name": "err",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 133,
    "kind": "method",
    "name": "publish",
    "memberof": "src/WebSimulatorImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebSimulatorImplement.js~ClientWrapper#publish",
    "access": "public",
    "description": null,
    "lineNumber": 286,
    "undocument": true,
    "params": [
      {
        "name": "arrayPattern",
        "types": [
          "number[]"
        ],
        "defaultRaw": [
          "null",
          "null",
          "0",
          "true"
        ],
        "defaultValue": "[null, null, 0, true]"
      },
      {
        "name": "callback",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 134,
    "kind": "method",
    "name": "request",
    "memberof": "src/WebSimulatorImplement.js~ClientWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebSimulatorImplement.js~ClientWrapper#request",
    "access": "public",
    "description": null,
    "lineNumber": 305,
    "undocument": true,
    "params": [
      {
        "name": "arrayPattern",
        "types": [
          "number[]"
        ],
        "defaultRaw": [
          "null",
          "null",
          "0",
          "true"
        ],
        "defaultValue": "[null, null, 0, true]"
      },
      {
        "name": "callback",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 135,
    "kind": "class",
    "name": "ChannelWebBridge",
    "memberof": "src/WebSimulatorImplement.js",
    "static": true,
    "longname": "src/WebSimulatorImplement.js~ChannelWebBridge",
    "access": "public",
    "export": true,
    "importPath": "@bone/channel/src/WebSimulatorImplement.js",
    "importStyle": "ChannelWebBridge",
    "description": null,
    "lineNumber": 45,
    "undocument": true,
    "interface": false
  },
  {
    "__docId__": 136,
    "kind": "member",
    "name": "moduleName",
    "memberof": "src/WebSimulatorImplement.js~ChannelWebBridge",
    "static": true,
    "longname": "src/WebSimulatorImplement.js~ChannelWebBridge.moduleName",
    "access": "public",
    "description": null,
    "lineNumber": 46,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 137,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "src/WebSimulatorImplement.js~ChannelWebBridge",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebSimulatorImplement.js~ChannelWebBridge#constructor",
    "access": "public",
    "description": null,
    "lineNumber": 48,
    "undocument": true
  },
  {
    "__docId__": 138,
    "kind": "member",
    "name": "bridge",
    "memberof": "src/WebSimulatorImplement.js~ChannelWebBridge",
    "static": false,
    "longname": "src/WebSimulatorImplement.js~ChannelWebBridge#bridge",
    "access": "public",
    "description": null,
    "lineNumber": 53,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 139,
    "kind": "member",
    "name": "mqttOptions",
    "memberof": "src/WebSimulatorImplement.js~ChannelWebBridge",
    "static": false,
    "longname": "src/WebSimulatorImplement.js~ChannelWebBridge#mqttOptions",
    "access": "public",
    "description": null,
    "lineNumber": 54,
    "undocument": true,
    "type": {
      "types": [
        "{}"
      ]
    }
  },
  {
    "__docId__": 140,
    "kind": "method",
    "name": "ready",
    "memberof": "src/WebSimulatorImplement.js~ChannelWebBridge",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebSimulatorImplement.js~ChannelWebBridge#ready",
    "access": "public",
    "description": null,
    "lineNumber": 59,
    "undocument": true,
    "params": [
      {
        "name": "arrayPattern",
        "types": [
          "*[]"
        ],
        "defaultRaw": [
          "null"
        ],
        "defaultValue": "[null]"
      },
      {
        "name": "callback",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 141,
    "kind": "method",
    "name": "subscribe",
    "memberof": "src/WebSimulatorImplement.js~ChannelWebBridge",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebSimulatorImplement.js~ChannelWebBridge#subscribe",
    "access": "public",
    "description": null,
    "lineNumber": 125,
    "undocument": true,
    "params": [
      {
        "name": "arrayPattern",
        "types": [
          "*[]"
        ],
        "defaultRaw": [
          "null"
        ],
        "defaultValue": "[null]"
      },
      {
        "name": "callback",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 142,
    "kind": "method",
    "name": "unsubscribe",
    "memberof": "src/WebSimulatorImplement.js~ChannelWebBridge",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebSimulatorImplement.js~ChannelWebBridge#unsubscribe",
    "access": "public",
    "description": null,
    "lineNumber": 129,
    "undocument": true,
    "params": [
      {
        "name": "arrayPattern",
        "types": [
          "*[]"
        ],
        "defaultRaw": [
          "null"
        ],
        "defaultValue": "[null]"
      },
      {
        "name": "callback",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 143,
    "kind": "method",
    "name": "publish",
    "memberof": "src/WebSimulatorImplement.js~ChannelWebBridge",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebSimulatorImplement.js~ChannelWebBridge#publish",
    "access": "public",
    "description": null,
    "lineNumber": 133,
    "undocument": true,
    "params": [
      {
        "name": "arrayPattern",
        "types": [
          "*[]"
        ],
        "defaultRaw": [
          "null",
          "null"
        ],
        "defaultValue": "[null, null]"
      },
      {
        "name": "callback",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 144,
    "kind": "method",
    "name": "request",
    "memberof": "src/WebSimulatorImplement.js~ChannelWebBridge",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/WebSimulatorImplement.js~ChannelWebBridge#request",
    "access": "public",
    "description": null,
    "lineNumber": 137,
    "undocument": true,
    "params": [
      {
        "name": "arrayPattern",
        "types": [
          "*[]"
        ],
        "defaultRaw": [
          "null",
          "null"
        ],
        "defaultValue": "[null, null]"
      },
      {
        "name": "callback",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 145,
    "kind": "file",
    "name": "src/constants.js",
    "content": "const CHANNEL = 'BoneChannel';\nconst CHANNEL_MESSAGE = 'message';\nconst CHANNEL_CONNECT_STATUS_CHANGE = 'connectStatusChange';\nconst CHANNEL_CONNECT_STATUS_CONNECTED = 'connected';\nconst CHANNEL_CONNECT_STATUS_DISCONNECTED = 'disconnected';\nconst CHANNEL_NA_DOWSTREAM = 'BoneDownstream';\nconst CHANNEL_NA_CONNECT_STATUS_CHANGE = 'BoneChannelConnectStatusChange';\n\nexport {\n    CHANNEL,\n    CHANNEL_MESSAGE,\n    CHANNEL_CONNECT_STATUS_CHANGE,\n    CHANNEL_CONNECT_STATUS_CONNECTED,\n    CHANNEL_CONNECT_STATUS_DISCONNECTED,\n    CHANNEL_NA_DOWSTREAM,\n    CHANNEL_NA_CONNECT_STATUS_CHANGE\n};",
    "static": true,
    "longname": "/Users/NicolasWan/Desktop/WorkSpace/JavaScript/aliplus/bone/channel/src/constants.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 146,
    "kind": "variable",
    "name": "CHANNEL",
    "memberof": "src/constants.js",
    "static": true,
    "longname": "src/constants.js~CHANNEL",
    "access": "public",
    "export": true,
    "importPath": "@bone/channel/src/constants.js",
    "importStyle": "{CHANNEL}",
    "description": null,
    "lineNumber": 1,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 147,
    "kind": "variable",
    "name": "CHANNEL_MESSAGE",
    "memberof": "src/constants.js",
    "static": true,
    "longname": "src/constants.js~CHANNEL_MESSAGE",
    "access": "public",
    "export": true,
    "importPath": "@bone/channel/src/constants.js",
    "importStyle": "{CHANNEL_MESSAGE}",
    "description": null,
    "lineNumber": 2,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 148,
    "kind": "variable",
    "name": "CHANNEL_CONNECT_STATUS_CHANGE",
    "memberof": "src/constants.js",
    "static": true,
    "longname": "src/constants.js~CHANNEL_CONNECT_STATUS_CHANGE",
    "access": "public",
    "export": true,
    "importPath": "@bone/channel/src/constants.js",
    "importStyle": "{CHANNEL_CONNECT_STATUS_CHANGE}",
    "description": null,
    "lineNumber": 3,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 149,
    "kind": "variable",
    "name": "CHANNEL_CONNECT_STATUS_CONNECTED",
    "memberof": "src/constants.js",
    "static": true,
    "longname": "src/constants.js~CHANNEL_CONNECT_STATUS_CONNECTED",
    "access": "public",
    "export": true,
    "importPath": "@bone/channel/src/constants.js",
    "importStyle": "{CHANNEL_CONNECT_STATUS_CONNECTED}",
    "description": null,
    "lineNumber": 4,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 150,
    "kind": "variable",
    "name": "CHANNEL_CONNECT_STATUS_DISCONNECTED",
    "memberof": "src/constants.js",
    "static": true,
    "longname": "src/constants.js~CHANNEL_CONNECT_STATUS_DISCONNECTED",
    "access": "public",
    "export": true,
    "importPath": "@bone/channel/src/constants.js",
    "importStyle": "{CHANNEL_CONNECT_STATUS_DISCONNECTED}",
    "description": null,
    "lineNumber": 5,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 151,
    "kind": "variable",
    "name": "CHANNEL_NA_DOWSTREAM",
    "memberof": "src/constants.js",
    "static": true,
    "longname": "src/constants.js~CHANNEL_NA_DOWSTREAM",
    "access": "public",
    "export": true,
    "importPath": "@bone/channel/src/constants.js",
    "importStyle": "{CHANNEL_NA_DOWSTREAM}",
    "description": null,
    "lineNumber": 6,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 152,
    "kind": "variable",
    "name": "CHANNEL_NA_CONNECT_STATUS_CHANGE",
    "memberof": "src/constants.js",
    "static": true,
    "longname": "src/constants.js~CHANNEL_NA_CONNECT_STATUS_CHANGE",
    "access": "public",
    "export": true,
    "importPath": "@bone/channel/src/constants.js",
    "importStyle": "{CHANNEL_NA_CONNECT_STATUS_CHANGE}",
    "description": null,
    "lineNumber": 7,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 153,
    "kind": "file",
    "name": "src/dist.js",
    "content": "import channel from './index';\n\n(function(global){\n    global.channel = channel;\n})(this);",
    "static": true,
    "longname": "/Users/NicolasWan/Desktop/WorkSpace/JavaScript/aliplus/bone/channel/src/dist.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 154,
    "kind": "file",
    "name": "src/index.js",
    "content": "import Inf from './Interface';\nimport Impl from './WebImplement';\nimport EventEmitter from '@bone/event-emitter';\nimport { CHANNEL, CHANNEL_MESSAGE, CHANNEL_CONNECT_STATUS_CHANGE } from './constants';\n\n// 构造bridge\nclass FakeBridge {\n    constructor(){\n        Object.assign(this, EventEmitter);\n\n        const channel = this.channel = new Impl({\n            bridge: this\n        });\n\n        // delegate event\n        channel.on(CHANNEL_CONNECT_STATUS_CHANGE, (...args)=>{\n            this.emit(CHANNEL_CONNECT_STATUS_CHANGE, ...args);\n        });\n    }\n\n    call(module, method, args, callback){\n        this.channel[method](args, callback);\n    }\n}\n\nexport default new Inf({\n    bridge: new FakeBridge\n});",
    "static": true,
    "longname": "/Users/NicolasWan/Desktop/WorkSpace/JavaScript/aliplus/bone/channel/src/index.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 155,
    "kind": "class",
    "name": "FakeBridge",
    "memberof": "src/index.js",
    "static": true,
    "longname": "src/index.js~FakeBridge",
    "access": "public",
    "export": false,
    "importPath": "@bone/channel/src/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 7,
    "undocument": true,
    "interface": false,
    "ignore": true
  },
  {
    "__docId__": 156,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "src/index.js~FakeBridge",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/index.js~FakeBridge#constructor",
    "access": "public",
    "description": null,
    "lineNumber": 8,
    "undocument": true
  },
  {
    "__docId__": 157,
    "kind": "method",
    "name": "call",
    "memberof": "src/index.js~FakeBridge",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/index.js~FakeBridge#call",
    "access": "public",
    "description": null,
    "lineNumber": 21,
    "undocument": true,
    "params": [
      {
        "name": "module",
        "types": [
          "*"
        ]
      },
      {
        "name": "method",
        "types": [
          "*"
        ]
      },
      {
        "name": "args",
        "types": [
          "*"
        ]
      },
      {
        "name": "callback",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "kind": "index",
    "content": "# Channel\n> Channel是阿里云IoT提供的长连接解决方案\n## 特性\n* 快速简单，只有5个接口，快速上手\n* 统一鉴权，无需关心安全问题\n* 高性能、高稳定性\n\n## 快速上手\n\n### 引入channel库\n```bash\nbnpm i --save @bone/channel\n```\n* bnpm为阿里云IoT提供的包管理工具，若第一次使用，可查看[安装指引](https://open.aliplus.com/bone/tool/bnpm.html)\n* 若需要直接引用channel.js，可以直接引用`lib/dist.min.js`\n\n\n### 使用接口开发\n```js\nimport channel from '@bone/channel';\nimport logger from '@bone/logger';\n\nlogger.conf = logger.DEF_CONF.development;\nconst log = logger.create({\n    module: 'index',\n    label: ['demo']\n});\n\nchannel\n    .ready({\n        // 用户id\n        id: '12345678',\n        // 用户token\n        token: 'xxxxxxxx'\n    })\n    .then(()=>{\n        log.info('channel ready'); \n\n        channel.subscribe('/demo/push', (...args)=>{\n            log.info('/demo/push received:', ...args);\n        });\n\n        channel.publish('/demo/push', { msg: 'hello' }, (...args)=>{\n            log.info('/demo/push delivered:', ...args);\n        });\n\n        channel.request('/demo/rpc', { msg: 'hello' }, (res)=>{\n            log.info('/demo/rpc response:', res);\n        });\n\n        channel.on(channel.EVENT_CONNECT_STATUS_CHANGE, (type)=>{\n            log.info('connect status changed:', msg);\n        });\n    })\n    .catch((err)=>{\n        log.warn('channel failed ready, you can retry later', err);\n    });\n```\n\n注意：\n* 上述demo使用ES6开发，因此依赖babel进行转换后方可正常运行，若不想使用babel，可以直接用ES5的方式开发\n* logger为Bone提供的日志工具，不是必选项，但是channel内部默认会使用logger打印日志，方便开发者调试\n\n## API文档\n> API文档详见[docs/index.html](./docs/class/src/Interface.js~ChannelInterface.html)，本文档由esdoc生成。",
    "longname": "/Users/NicolasWan/Desktop/WorkSpace/JavaScript/aliplus/bone/channel/README.md",
    "name": "./README.md",
    "static": true,
    "access": "public"
  },
  {
    "kind": "packageJSON",
    "content": "{\n  \"name\": \"@bone/channel\",\n  \"version\": \"0.1.13\",\n  \"description\": \"channel为基于mqtt的长连接通信协议封装，可直接使用完整库，也可以单独引用接口层（使用Native SDK时）或实现层（模拟Native SDK bridge）\",\n  \"main\": \"lib/index.js\",\n  \"scripts\": {\n    \"build\": \"npm run buildLib; npm run buildDist; npm run doc\",\n    \"buildLib\": \"babel src --out-dir lib\",\n    \"buildDist\": \"webpack --env=prod --progress --profile --colors\",\n    \"prepublish\": \"npm run build\",\n    \"test\": \"echo \\\"Error: no test specified\\\" && exit 1\",\n    \"doc\": \"esdoc\"\n  },\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"git+http://gitlab.alibaba-inc.com/bone/channel.git\"\n  },\n  \"keywords\": [\n    \"mqtt\",\n    \"websocket\"\n  ],\n  \"author\": \"amos\",\n  \"license\": \"ISC\",\n  \"devDependencies\": {\n    \"babel-cli\": \"^6.26.0\",\n    \"babel-core\": \"^6.26.0\",\n    \"babel-loader\": \"^7.1.2\",\n    \"babel-plugin-transform-class-properties\": \"^6.24.1\",\n    \"babel-preset-env\": \"^1.6.1\",\n    \"esdoc\": \"^1.0.4\",\n    \"esdoc-ecmascript-proposal-plugin\": \"^1.0.0\",\n    \"esdoc-standard-plugin\": \"^1.0.0\",\n    \"uglifyjs-webpack-plugin\": \"^1.0.1\",\n    \"webpack\": \"^3.8.1\"\n  },\n  \"dependencies\": {\n    \"@bone/event-emitter\": \"^0.1.4\",\n    \"@bone/logger\": \"^0.1.6\",\n    \"@bone/paho-client\": \"^0.1.0\"\n  }\n}\n",
    "longname": "/Users/NicolasWan/Desktop/WorkSpace/JavaScript/aliplus/bone/channel/package.json",
    "name": "package.json",
    "static": true,
    "access": "public"
  }
]